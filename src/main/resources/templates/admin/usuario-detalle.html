<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Admin - Detalle de Cliente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 th:text="${'Cliente: ' + usuario.nombre}">Cliente</h1>
        <a th:href="@{/admin/pedidos}" class="btn btn-secondary">Volver a pedidos</a>
    </div>

    <!-- ---------- DATOS PERSONALES ---------- -->
    <div class="card mb-4">
        <div class="card-header">
            Datos del usuario
        </div>
        <div class="card-body">
            <dl class="row mb-0">
                <dt class="col-sm-3">ID</dt>
                <dd class="col-sm-9" th:text="${usuario.id}"></dd>

                <dt class="col-sm-3">Nombre</dt>
                <dd class="col-sm-9" th:text="${usuario.nombre}"></dd>

                <dt class="col-sm-3">Email</dt>
                <dd class="col-sm-9" th:text="${usuario.email}"></dd>

                <dt class="col-sm-3">Rol</dt>
                <dd class="col-sm-9" th:text="${usuario.rol}"></dd>

                <dt class="col-sm-3">Dirección</dt>
                <dd class="col-sm-9"
                    th:text="${usuario.direccion != null && !#strings.isEmpty(usuario.direccion) ? usuario.direccion : 'No especificada'}">
                </dd>

                <dt class="col-sm-3">Teléfono</dt>
                <dd class="col-sm-9"
                    th:text="${usuario.telefono != null && !#strings.isEmpty(usuario.telefono) ? usuario.telefono : 'No especificado'}">
                </dd>
            </dl>
        </div>
    </div>


    <!-- ---------- RESUMEN DE ACTIVIDAD ---------- -->
    <div class="row">

        <!-- RESUMEN PEDIDOS -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header">Resumen de pedidos</div>
                <div class="card-body">
                    <p class="mb-0">
                        <strong>Número de pedidos:</strong>
                        <span th:text="${pedidosUsuario != null ? #lists.size(pedidosUsuario) : 0}">0</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- RESUMEN RESEÑAS -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header">Resumen de reseñas</div>
                <div class="card-body">
                    <p class="mb-0">
                        <strong>Número de reseñas:</strong>
                        <span th:text="${resenasUsuario != null ? #lists.size(resenasUsuario) : 0}">0</span>
                    </p>
                </div>
            </div>
        </div>

    </div>

    <!-- ---------- TABLA DE PEDIDOS ---------- -->
    <div class="card mb-4">
        <div class="card-header">
            Pedidos del usuario
        </div>
        <div class="card-body">

            <div th:if="${#lists.isEmpty(pedidosUsuario)}">
                <p class="text-muted">Este usuario no tiene pedidos registrados.</p>
            </div>

            <div th:if="${!#lists.isEmpty(pedidosUsuario)}">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Fecha</th>
                        <th>Estado</th>
                        <th>Total</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="p : ${pedidosUsuario}">
                        <td th:text="${p.id}"></td>
                        <td th:text="${p.fechaPedido}"></td>
                        <td th:text="${p.estado}"></td>
                        <td th:text="${p.total}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>

        </div>
    </div>

</div>

<div th:replace="~{fragments/footer :: footer}"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
